<!DOCTYPE html>
<html> 
<head>    
    <!--Link the css file-->
    <link rel="stylesheet" type="text/css" href="index.css">
    <title>Theo's Data Portfolio</title>
    <!-- Link VegaLite -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <style>
        #chartGrid {
            display: flex;
        }
        
    </style>
</head>

<body> 
    <nav>     
        <ul class="bar">
            <li class="headTitle">Data Science for Economist Project    |   Theo Lam</li>
            <li><a href="https://www.github.com/TheoLam00">GitHub</a></li>
            <li><a href="#Project">Data Profolio</a></li>
            <li><a href="#CC">Coding Challenges</a></li>
        </ul>
    </nav>
    <br>
    <section>
        <div class="chart-description">
            <h2>Section 1: Introduction</h2>
            <h3 class="small">
                This page records my learning progress on coding a website and make graphs with live data using <a href="https://vega.github.io/vega-lite">Vega-Lite</a>.
            </h3>
            <h3 class="small"> 
                For more codes on how the graphs are made or data cleaning, please go to my <a href="https://www.github.com/TheoLam00/TheoLam00.github.io">github repository</a>.
            </h3>
        </div>
        <figure id="Example"></figure>
        <p>This is an example on displaying a chart with vega lite.</p>
    </section>

    <section id = "CC" class="colorCC">
        <h2>Section 2: Coding Challenges</h2>
        <button type="button" class="showButton" onclick="showAll()">Show all</button>
        <button type="button" class="showButton" onclick="hideAll()">Hide all</button>
        <br>
        <!--CC1-->
        <button type="button" class="expandButton" onclick="show(1)"><h3>CC1</h3><figure id="figButton1" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(1)" class="collaspeButton"><h3>CC 1: Hosting. Display charts in your own site.</h3></button><br>
            <figure id="Location1" class = "graph"></figure>
            <figure id="Location2" class = "graph"></figure>
            <p>Displaying two graphs with vegaembed function</p>
            <p>Graph samples are from <a href="https://rdeconomist.github.io/library">Rdeconomist</a></p>
        </div>

        <!--CC2-->
        <button type="button" class="expandButton" onclick="show(2)"><h3>CC2</h3><figure id="figButton2" class="figButton"></figure></button>
        <div class = "box">
        <button type="button" onclick="hide(2)" class="collaspeButton"><h3>CC 2: Building. Create your own visualisations</h3></button><br>
            <figure id="Location3" class = "graph"></figure>
            <figure id="Location4" class = "graph"></figure>
            <p>Using Vega Lite to create two charts with data from <a href="https://www.economicsobservatory.com/create">EconomicsObservatory</a></p>
        </div>

        <!--CC3-->
        <button type="button" class="expandButton" onclick="show(3)"><h3>CC3</h3><figure id="figButton3" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(3)" class="collaspeButton"><h3>CC 3: Debating. Use a visualisation in economic/policy commentary</h3> </button><br>
            <figure id="Location5" class = "graph"></figure>
            <figure id="Location6" class = "graph"></figure>
            <p>The data from ONS and gov.uk shows that black ethnic groups are not significantly being bullied more or having less entry rate to higher education</p>
        </div>

        <!--CC4-->
        <button type="button" class="expandButton" onclick="show(4)"><h3>CC4</h3><figure id="figButton4" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(4)" class="collaspeButton"><h3>CC4:  Replication. Re-create, then improve, someone else chart</h3></button><br>
            <img src="cc4/cc4.jpg" height="500" width="600">
            <figure id="Location7" class = "graph"></figure>
            <p>The graph y-axis is now starting from zero and the drop in November is more obvious than other months as in the data</p>
        </div>

        <!--CC5-->
        <button type="button" class="expandButton" onclick="show(5)"><h3>CC5</h3><figure id="figButton5" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(5)" class="collaspeButton"><h3>CC5: Scraper. Implement a data scraper of your own.</h3></button><br>
            <p>The data was cleaned using code in <a href="https://colab.research.google.com/github/TheoLam00/TheoLam00.github.io/blob/main/cc5/CC5.ipynb">google colab python notebook</a></p>
            <figure id="CC5" class = "graph"></figure>
            <p>World Bank have data of different countries in the world in same format. So it will be easier to compare data of countries</p>
        </div>

        <!--CC6-->
        <button type="button" class="expandButton" onclick="show(6)"><h3>CC6</h3><figure id="figButton6" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(6)" class="collaspeButton"><h3>CC6: Loops. Build a dashboard.</h3></button><br>
        <p>The JSON files were downloaded using this <a href="https://colab.research.google.com/github/TheoLam00/TheoLam00.github.io/blob/main/cc6/CC6.ipynb">code</a></p>
        <figure id="cc6-1" class="graph_cc6"></figure>
        <figure id="cc6-2" class="graph_cc6"></figure>
        <figure id="cc6-3" class="graph_cc6"></figure>
        <figure id="cc6-4" class="graph_cc6"></figure>
        <figure id="cc6-5" class="graph_cc6"></figure>
        <figure id="cc6-6" class="graph_cc6"></figure>
        <figure id="cc6-7" class="graph_cc6"></figure>
        <figure id="cc6-8" class="graph_cc6"></figure>
        <figure id="cc6-9" class="graph_cc6"></figure>
        </div>

        <!--CC7-->
        <button type="button" class="expandButton" onclick="show(7)"><h3>CC7</h3><figure id="figButton7" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(7)" class="collaspeButton"><h3>CC7: Maps. Base maps and choropleths.</h3></button><br>
        <figure id="cc7-1" class="graph"></figure>
        <figure id="cc7-2" class="graph"></figure>
        <p>This map used data from <a href="https://github.com/mmcloughlin/starbucks/blob/master/locations.json">mmcloughlin's github</a></p>
        <p>Failed to find data of cappuccino price in usa (something like we did in class). So instead only showing the location of Starbucks.</p>
        </div>

        <!--CC8-->
        <button type="button" class="expandButton" onclick="show(8)"><h3>CC8</h3><figure id="figButton8" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(8)" class="collaspeButton"><h3>CC8: Analytics charts.</h3></button><br>
        <figure id="cc8_1" class="graph"></figure>
        <p>This is inspired by work <a href="#didRef">Card and Krueger (1994)</a></p>
        <p>Although there seems to have a different in the trend of unemployment in these two similar states. The different start far before the raise in minimum wage on 1st April 1992</p>
        <figure id="cc8_2" class="graph"></figure>
        </div>

        <!--CC9-->
        <button type="button" class="expandButton" onclick="show(9)"><h3>CC9</h3><figure id="figButton9" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(9)" class="collaspeButton"><h3>CC9: Big Data. Extracting a story from millions of prices.</h3></button><br>
        <figure id="cc9_1" class="graph"></figure>
        <figure id="cc9_2" class="graph"></figure>
        <p>The figures take data from class <a href="https://www.dropbox.com/scl/fo/phq41r2641wp2f454l2gs/AFIIt5xY_WCZeHF20r1r9sg?rlkey=eg1mulaydwbmdwixsefh7bnlb&e=1&dl=0">dropbox</a>
             and created two graphs of egg and milk price density overtime and one of the outliner (over 100pounds) were filtered from the data
            the colour shows how many data of that item was priced within that price range</p>
        </div>

        <!--CC10-->
        <button type="button" class="expandButton" onclick="show(10)"><h3>CC10</h3><figure id="figButton10" class="figButton"></figure></button>
        <div class="box">
        <button type="button" onclick="hide(10)" class="collaspeButton"><h3>CC10: Interactive Visualisations</h3></button><br>
        <figure id="cc10_1" class="graph"></figure>
        <!--The graph will be use in the project. The python notebook on cleaning the data is in the file project/unem-->
        <figure id="cc10_2" class="graph"></figure>
        </div>
    </section>

    <section id = "Project" class="colorProj">
        <h2>Section 3: Data Profolio</h2>
        <h1 class="big">Voting Behaviour in US: Democrats or Republicant</h1>

        <!--Aim-->
        <p><b>Aim:</b><br>The US presidential election is voted by the Electoral College. All representatives in the state will vote for the winner of the popular vote in that state, no matter how close the votes are. 
            This makes some states 'swing' because it is uncertain which candidate the votes will go to. In this project, I will use visuallization to show how Employment and industry of a state affect the voters to tends voting to a particular party.
            Although only around 20% of the electoral college votes are in the swing state, this still heavily affect the result of the election as the sum of electoral votes of each parties are nearly tied in other states.</p>
        
        <figure id="pVote" class="graph"></figure><br>

        <p>Taking data of voting results in every states of the past presidential election from <a href="https://electionlab.mit.edu/data">MIT election data and science lab</a>. After cleaning with python, the graph shows the winner's party of that state.
        The 'demRatio' is showing percentage of vote the Democrats candidate get over the total votes of the two most potential candidates.</p><br>
        
        <figure id="swing" class="graph"></figure><br>

        <p>This graph shows the swing state which votes were differ by a few percent. The different parameter allow user to choose the different in percentage the candidates got. The different less than the choice will be marked as grey.</p><br>
        
        <figure id="swingVoteRate" class="graph"></figure><br>

        <p>Data from <a href="https://www.census.gov/data/tables/time-series/demo/voting-and-registration/voting-historical-time-series.html">United States Census Bureau</a> shows no obvious trends on the graph. Although their vote could make a different, swing state do not have a significantly higher turnout rate.
        The swing index is the absolute different of vote from 50%, showing how close was the election results. Whch was plotted with the data of voting to Democrat cleaned from MIT</p>

        <figure id="spending" class="graph"></figure><br>

        <p>Data from <a href="https://www.fec.gov/data/candidates/president/presidential-map/">Federal Election Commision</a> is scraped by python. Requesting the zip file and filter the two candidate and summing all the expenses by state. It shows the spending on campaign of each candidate.
        Which increace exponentially with the swingIndex. Voters in the swing state are much more considered by the candidate. Spending is also higher the more Electoral vote (Bubble size) the state got.
        The swing checkbox is choosing the plot against percentage of Democrats votes and swing (how close the result differ to 50%).</p>

        <figure id="unemployment" class="graph"></figure><br>

        <p>The data is accessed by the Fred api using python. Using a loop to get and merge the data of different states. And parameters are add to allow users to choose data from time period and states.</p>
        <figure id="unemDem" class="graph"></figure><br>
        <p>After scraping and combining the data from fred and MIT, the result shows unemployment slightly favour the Democratic party's candidate.</p>
        <figure id="employee" class="graph"></figure><br>
        <figure id="parti" class="graph"></figure><br>
        <p>These two graphs were plotted by cleaning <a href="https://www.census.gov/data/datasets/2020/econ/cbp/2020-cbp.html">data</a> by <a href="https://github.com/TheoLam00/TheoLam00.github.io/blob/main/project/cbp/CBP.ipynb">python</a>. Showing the participation rate of different industries.</p>
        
        <!--Challenges-->
        <p><b>Challenges:</b><br>I originally decided to plot unemployment against swing index and turnout rate.
            But the data shows no obvious relationship in the graph. Different from <a href="https://www.ox.ac.uk/news/2021-06-28-previous-unemployment-influences-voter-turnout-says-oxford-study-0">findings</a> that unemployment will affect turnout rate.
            Research of <a href="https://www.nber.org/papers/w24425">swing state theory</a> finds that swing state benefits from tariffs. I also looked for taxrate, to see if there are similar trends. 
            But also failed to find significant trends. Those graphs were ploted by seaborn in google colab notebook on my github. So I changed the project direction from swing state to what makes a Democrat or Republican voter.
            Also, the presidential election held every 4 years, so there is not much data. And there are only data of voting in a society as a whole, not how individuals votes. 
            Some of the data are too big so I have to load it on google colab and clean it before uploading to github. And some data's api are missing or the data's column are named differently in older data. 
            It takes extra time to spot out these errors using a for loop to requests the data in python.</p>
        
        <!--Conclusion-->
        <p><b>Conclusion:</b><br>From the last three graphs, a higher unemployment rate benefits the Democratic party. Although the data only shows the overall votes of the state, most industries with higher wages tend to have higher overall votes on Democrats. 
            Some industries such as education, science and technology sectors also benefit the Democratic party, as the participation rate increases votes increase. Industries such as utilities and construction benefit Republicans. This also explains why some states are 'loyal' to Democrats or Republicans. 
            The industry structure of a state is hard to change in short run. As the party benefits their industry they will continue voting for that party. But this loyalty will cause less considered by the candidates in the campaign as the swing states. 
            Candidate spends more in campaigning in swing state, which increase exponentially when the state is more swing. And to win more vote, spending is higher in swing states with more Electoral college votes.</p>
        
        <!--Reference-->
        <div>
            <h3>Reference</h3>
            <p><a href="https://dataverse.harvard.edu/file.xhtml?fileId=7241480">MIT Election Data and Science Lab, 2017, "U.S. President 1976–2020", https://doi.org/10.7910/DVN/42MVDX, Harvard Dataverse, V8, UNF:6:F0opd1IRbeYI9QyVfzglUw== [fileUNF]</a></p>
            <p id="didRef">Card, David, and Alan B. Krueger. “Minimum Wages and Employment: A Case Study of the Fast-Food Industry in New Jersey and Pennsylvania: Reply.” The American Economic Review 90, no. 5 (2000): 1397–1420. http://www.jstor.org/stable/2677856.</p>
        </div>
    </section>

    <script>
        // This is a comment in JavaScript - it's a different language to HTML and CSS cc1-4
        let example_fig = "https://raw.githubusercontent.com/EconomicsObservatory/courses/main/2/s2_chart2.json";
        let figure_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/wk1_chart1.json"; // We're storing the URL of the graph we want to display in a variable                                                                                                      // You should have a spec for a graph in this same folder. Just specify its name here, e.g. let figure_1_spec = "chart1.json"
        let figure_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/wk1_chart2.json";
        let wk2_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/wk2_1.json";
        let wk2_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/wk2_2.json";
        let wk3_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc3/cc3_1.json";
        let wk3_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc3/cc3_2.json";
        let cc4 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc4/cc4.json";
        
        vegaEmbed('#Example',example_fig);
        vegaEmbed('#Location1', figure_1);
        vegaEmbed('#Location2', figure_2);
        vegaEmbed('#Location3', wk2_1);
        vegaEmbed('#Location4', wk2_2);
        vegaEmbed('#Location5', wk3_1);
        vegaEmbed('#Location6', wk3_2);
        vegaEmbed('#Location7', cc4);
        //cc5
        let cc5 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc5/cc5.json";
        vegaEmbed('#CC5', cc5);
        //cc6
        let cc6_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/Manufacturing_index.json";
        let cc6_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/female_unemployment.json";
        let cc6_3 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/gdp_growth.json";
        let cc6_4 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/inflation.json";
        let cc6_5 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/male_unemployment.json";
        let cc6_6 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/population.json";
        let cc6_7 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/service_output.json";
        let cc6_8 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/total_output.json";
        let cc6_9 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc6/unemployment.json";

        vegaEmbed('#cc6-1', cc6_1);
        vegaEmbed('#cc6-2', cc6_2);
        vegaEmbed('#cc6-3', cc6_3);
        vegaEmbed('#cc6-4', cc6_4);
        vegaEmbed('#cc6-5', cc6_5);
        vegaEmbed('#cc6-6', cc6_6);
        vegaEmbed('#cc6-7', cc6_7);
        vegaEmbed('#cc6-8', cc6_8);
        vegaEmbed('#cc6-9', cc6_9);

        //cc7
        let cc7_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc7/USmap.json";
        let cc7_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc7/starbuckMap.json";
        vegaEmbed('#cc7-1', cc7_1);
        vegaEmbed('#cc7-2', cc7_2);

        //cc8
        let cc8_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc8/cc8_1.json";
        vegaEmbed('#cc8_1',cc8_1);
        let cc8_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/dem%26unem.json";
        vegaEmbed('#cc8_2',cc8_2);

        //cc9
        let cc9_1 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc9/cc9_egg.json";
        let cc9_2 = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/cc9/cc9_milk.json";
        vegaEmbed('#cc9_1',cc9_1);
        vegaEmbed('#cc9_2',cc9_2);

        //cc10
        let unemployment = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/unem/unemployment.json";
        let presidentVote = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/pVote/pVote.json"
        vegaEmbed('#cc10_1',unemployment);
        vegaEmbed('#cc10_2',presidentVote);

        //expand button
        vegaEmbed('#figButton1', figure_1);
        vegaEmbed('#figButton2', wk2_1);
        vegaEmbed('#figButton3', wk3_1);
        vegaEmbed('#figButton4', cc4);
        vegaEmbed('#figButton5', cc5);
        vegaEmbed('#figButton6', cc6_1);
        vegaEmbed('#figButton7', cc7_1);
        vegaEmbed('#figButton8', cc8_1);
        vegaEmbed('#figButton9', cc9_1);
        vegaEmbed('#figButton10', unemployment);

        function showAll(){
            var show = document.querySelectorAll(".box");
            var but = document.querySelectorAll(".expandButton");
            for (let i=0;i<show.length;i++){
                but[i].style.display = "none";
                show[i].style.display = "block";
            }
            containerBug();
        }

        function show(i){
            var show = document.querySelectorAll(".box");
            var but = document.querySelectorAll(".expandButton");
            but[i-1].style.display = "none";
            show[i-1].style.display = "block";
            containerBug();
        }

        function hideAll(){
            var show = document.querySelectorAll(".box");
            var but = document.querySelectorAll(".expandButton");
            for (let i=0;i<show.length;i++){
                show[i].style.display = "none";
                but[i].style.display = "inline-block";
            }
            containerBug();
        }

        function hide(i){
            var show = document.querySelectorAll(".box");
            var but = document.querySelectorAll(".expandButton");
            show[i-1].style.display = "none";
            but[i-1].style.display = "inline-block";
            containerBug();
        }

        //To fix the graph size to container not showing bug
        function containerBug(){
            window.dispatchEvent(new Event('resize'));
        }

        //project graph
        vegaEmbed("#pVote",presidentVote);
        let swingState = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/swingState/swing.json";
        vegaEmbed("#swing",swingState);
        let swingVote = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/voteRate/swingVSvoteRate.json";
        vegaEmbed('#swingVoteRate',swingVote);
        vegaEmbed('#unemployment',unemployment);
        let unemDem = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/dem%26unem.json";
        vegaEmbed('#unemDem',unemDem);
        let wage = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/cbp/industryWageVote.json";
        let parti = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/cbp/industryPartiVote.json";
        vegaEmbed('#employee',wage);
        vegaEmbed('#parti',parti);
        let spending = "https://raw.githubusercontent.com/TheoLam00/TheoLam00.github.io/refs/heads/main/project/spending/spendingVote.json";
        vegaEmbed('#spending',spending);
    </script>

</body>
    
</html>
